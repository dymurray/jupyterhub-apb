FROM ansibleplaybookbundle/apb-base:canary

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IGp1cHl0ZXJodWItYXBiCmRlc2NyaXB0aW9uOiB5b3VyIGRlc2Ny\
aXB0aW9uCmJpbmRhYmxlOiBGYWxzZQphc3luYzogb3B0aW9uYWwKbWV0YWRhdGE6CiAgZGlzcGxh\
eU5hbWU6IGp1cHl0ZXJodWItYXBiCnBsYW5zOgogIC0gbmFtZTogZGVmYXVsdAogICAgZGVzY3Jp\
cHRpb246IFRoaXMgZGVmYXVsdCBwbGFuIGRlcGxveXMganVweXRlcmh1Yi1hcGIKICAgIGZyZWU6\
IFRydWUKICAgIG1ldGFkYXRhOiB7fQogICAgcGFyYW1ldGVyczoKICAgICAgLSBuYW1lOiBkYl9t\
ZW1vcnkKICAgICAgICB0eXBlOiBlbnVtCiAgICAgICAgZW51bTogWyc1MTJNaSddCiAgICAgICAg\
ZGVmYXVsdDogJzUxMk1pJwogICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgIC0gbmFtZTogZGJf\
cGFzc3dvcmQKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICByZXF1aXJlZDogdHJ1ZQogICAg\
ICAtIG5hbWU6IGNvb2tpZV9zZWNyZXQKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICByZXF1\
aXJlZDogdHJ1ZQogICAgICAtIG5hbWU6IGp1cHl0ZXJodWJfbWVtb3J5CiAgICAgICAgdHlwZTog\
ZW51bQogICAgICAgIGVudW06IFsnNTEyTWknXQogICAgICAgIGRlZmF1bHQ6ICc1MTJNaScKICAg\
ICAgICByZXF1aXJlZDogdHJ1ZQogICAgICAtIG5hbWU6IG5vdGVib29rX2ltYWdlCiAgICAgICAg\
dHlwZTogZW51bQogICAgICAgIGVudW06IFsnczJpLW1pbmltYWwtbm90ZWJvb2s6My41J10KICAg\
ICAgICByZXF1aXJlZDogdHJ1ZQogICAgICAgIGRlZmF1bHQ6ICdzMmktbWluaW1hbC1ub3RlYm9v\
azozLjUnCiAgICAgIC0gbmFtZTogbm90ZWJvb2tfbWVtb3J5CiAgICAgICAgdHlwZTogZW51bQog\
ICAgICAgIGVudW06IFsnNTEyTWknXQogICAgICAgIGRlZmF1bHQ6ICc1MTJNaScKICAgICAgICBy\
ZXF1aXJlZDogdHJ1ZQoK"

COPY playbooks /opt/apb/actions
COPY . /opt/ansible/roles/jupyterhub-apb
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
